<%= form_with(model: [:admin, collection], class: "space-y-8") do |form| %>

  <% if collection.errors.any? %>
    <div class="bg-red-50 border border-red-200 px-5 py-4">
      <p class="text-sm font-semibold text-red-700 mb-2">
        <%= pluralize(collection.errors.count, "error") %> prevented this collection from being saved:
      </p>
      <ul class="list-disc list-inside text-sm text-red-600 space-y-1">
        <% collection.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Title %>
  <div>
    <%= form.label :title, "Collection Title", class: "block text-xs font-semibold tracking-widest uppercase text-gray-500 mb-2" %>
    <%= form.text_field :title,
      placeholder: "e.g. Editor's Picks, Weekend Reads…",
      class: "w-full text-xl font-bold border-0 border-b-2 border-gray-200 focus:border-gray-900 focus:outline-none focus:ring-0 py-2 px-0 placeholder-gray-300 bg-transparent transition-colors" %>
  </div>

  <%# Articles dropdown (Tom Select) %>
  <div>
    <label class="block text-xs font-semibold tracking-widest uppercase text-gray-500 mb-2">Articles</label>
    <select name="collection[article_ids][]"
            id="collection_article_ids"
            multiple
            data-controller="tom-select"
            class="w-full">
      <% @articles.each do |article| %>
        <option value="<%= article.id %>"
                <%= "selected" if collection.article_ids.include?(article.id) %>>
          <%= article.title %><%= article.category ? " — #{article.category.name}" : "" %>
        </option>
      <% end %>
    </select>
  </div>

  <%# Actions %>
  <div class="flex items-center gap-4 pt-4 border-t border-gray-100">
    <%= form.submit collection.new_record? ? "Create Collection" : "Save Changes",
      class: "bg-gray-900 text-white text-xs font-semibold tracking-widest uppercase px-6 py-2.5 hover:bg-gray-700 transition-colors cursor-pointer" %>
    <%= link_to "Cancel", admin_collections_path,
      class: "text-xs font-semibold text-gray-400 hover:text-gray-700 transition-colors" %>
  </div>

<% end %>
