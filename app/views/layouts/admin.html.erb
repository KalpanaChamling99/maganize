<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Admin – The Magazine</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50 text-gray-900 font-sans antialiased">
    <div class="flex min-h-screen">

      <%# ── Sidebar ──────────────────────────────────────────────── %>
      <aside class="w-60 bg-gray-900 text-white flex flex-col fixed inset-y-0 left-0 z-30">

        <%# Branding %>
        <div class="px-6 py-5 border-b border-gray-800">
          <span class="font-serif text-xl font-bold tracking-tight">The Magazine</span>
          <p class="text-xs text-gray-500 mt-0.5 tracking-widest uppercase">Admin Panel</p>
        </div>

        <%# Navigation %>
        <nav class="flex-1 px-3 py-5 space-y-0.5 overflow-y-auto">

          <%# Dashboard %>
          <%= link_to admin_root_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium transition-colors #{current_page?(admin_root_path) ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'}" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            Dashboard
          <% end %>

          <%# Divider + label %>
          <div class="pt-4 pb-1 px-3">
            <p class="text-xs font-semibold tracking-widest uppercase text-gray-600">Content</p>
          </div>

          <%# Articles %>
          <%= link_to admin_articles_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium transition-colors #{request.path.start_with?('/admin/articles') ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'}" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            Articles
            <span class="ml-auto text-xs bg-white/10 px-2 py-0.5 rounded-full"><%= Article.count %></span>
          <% end %>

          <%# Categories %>
          <%= link_to admin_categories_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium transition-colors #{request.path.start_with?('/admin/categories') ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'}" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
            </svg>
            Categories
            <span class="ml-auto text-xs bg-white/10 px-2 py-0.5 rounded-full"><%= Category.count %></span>
          <% end %>

          <%# Tags %>
          <%= link_to admin_tags_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium transition-colors #{request.path.start_with?('/admin/tags') ? 'bg-white/10 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'}" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A2 2 0 013 12V7a4 4 0 014-4z"/>
            </svg>
            Tags
            <span class="ml-auto text-xs bg-white/10 px-2 py-0.5 rounded-full"><%= Tag.count %></span>
          <% end %>

          <%# Divider %>
          <div class="pt-4 pb-1 px-3">
            <p class="text-xs font-semibold tracking-widest uppercase text-gray-600">Quick Add</p>
          </div>

          <%= link_to new_admin_article_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium text-gray-400 hover:bg-white/5 hover:text-white transition-colors" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
            </svg>
            New Article
          <% end %>

          <%= link_to new_admin_category_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium text-gray-400 hover:bg-white/5 hover:text-white transition-colors" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
            </svg>
            New Category
          <% end %>

          <%= link_to new_admin_tag_path,
            class: "flex items-center gap-3 px-3 py-2.5 rounded text-sm font-medium text-gray-400 hover:bg-white/5 hover:text-white transition-colors" do %>
            <svg class="h-4 w-4 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
            </svg>
            New Tag
          <% end %>

        </nav>

        <%# Footer — view site link %>
        <div class="px-4 py-4 border-t border-gray-800">
          <%= link_to root_path,
            class: "flex items-center gap-2 text-xs text-gray-500 hover:text-white transition-colors",
            target: "_blank" do %>
            <svg class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
            </svg>
            View site
          <% end %>
        </div>
      </aside>

      <%# ── Main content area ────────────────────────────────────── %>
      <div class="flex-1 ml-60 flex flex-col min-h-screen">

        <%# Top bar %>
        <header class="bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between sticky top-0 z-20">
          <div>
            <% if content_for?(:page_title) %>
              <h2 class="text-base font-semibold text-gray-900"><%= yield :page_title %></h2>
            <% end %>
          </div>
          <div class="flex items-center gap-4">
            <% if content_for?(:header_action) %>
              <%= yield :header_action %>
            <% end %>
            <span class="text-xs text-gray-400"><%= Date.today.strftime("%B %-d, %Y") %></span>
          </div>
        </header>

        <%# Flash notices %>
        <% if notice.present? %>
          <div class="mx-8 mt-4 bg-green-50 border border-green-200 text-green-800 text-sm px-4 py-3 flex items-center justify-between" id="flash-notice">
            <span><%= notice %></span>
            <button onclick="document.getElementById('flash-notice').remove()" class="text-green-600 hover:text-green-900 ml-4 text-lg leading-none">&times;</button>
          </div>
        <% end %>
        <% if alert.present? %>
          <div class="mx-8 mt-4 bg-red-50 border border-red-200 text-red-800 text-sm px-4 py-3 flex items-center justify-between" id="flash-alert">
            <span><%= alert %></span>
            <button onclick="document.getElementById('flash-alert').remove()" class="text-red-600 hover:text-red-900 ml-4 text-lg leading-none">&times;</button>
          </div>
        <% end %>

        <%# Page content %>
        <main class="flex-1 px-8 py-8">
          <%= yield %>
        </main>
      </div>

    </div>
  </body>
</html>
